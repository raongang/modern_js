<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <title>Closure</title>
</head>

<script>   

    /* 클로저 : 함수객체와 렉시컬 환경 컴포넌트의 집합. */    
    // 8.6.2 클로저의 성질.
    function makeCounter(){ //makeCounter:외부함수
        var count=0; //전역변수
        return f;
        function f(){ //중첩함수
            return count++;
        }    
    }
    
    console.log("=======================================================================");
    var counter = makeCounter();
    console.log(counter()); //0
    console.log(counter()); //1
    console.log(counter()); //2
    console.log(counter.count);    
    
    console.log("=======================================================================");
    
    //anonymous function 
    function makeCounter(){
        var count=0;
        return function(){
            return count++;
        }
    };
    var counter = makeCounter();
    console.log(counter());
    console.log(counter());
    console.log(counter());
    
    console.log("=======================================================================");
    //클로저 예제1 - 여러 개의 내부 상태와 메소드를 가진 클로저
    
    function Person(name,age){
        var _name = name;
        var _age = age;
        
        //※ return을 할경우 메소드(객체에 있는 함수)를 여러개 가진 객체를 리턴가능.
        return {
          getName: function(){return _name;},
          getAge:  function(){return _age;},
          setAge : function(x) {_age=x;}                      
        };
    }
    
    var person = Person("Tom",18);
    console.log(person.getName());
    console.log(person.getAge());
    person.setAge(19);
    console.log(person.getAge());
    
    //클로저 예제2 - 함수팩토리
    function makeMultiplier(x){
        return function(y){
            return x*y;
        }
    }
    
    //동일하게 makeMultiplier이라는 함수 몸통을 공유하지만, 각자가
    //보유한 렉시컬 환경이 다름.
    var multi2 = makeMultiplier(2);
    var multi10 = makeMultiplier(10);
     console.log("=======================================================================");
    
    console.log(multi2(3));
    console.log(multi10(3));
    
   
   
</script>    
<body>
 
</body>
</html>


